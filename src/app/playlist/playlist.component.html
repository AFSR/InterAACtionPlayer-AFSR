<div class="ui centered grid">
  <div class="fourteen wide column">
    <h1 class="ui centered aligned header">
      <span>My PlayList</span>
    </h1>
    <div class="ui secondary menu">
      <div class="right menu">
        <a class="ui item" (click)="openSave()">
          <i class="save icon"></i>
        </a>
        <label (click)="openImport()">
          <a class="ui item">
            <i class="upload icon"></i>
          </a>
        </label>
        <a class="ui item" (click)="goEdit()">
          <i class="edit icon"></i>
        </a>
        <a class="ui item" (click)="openSettings()">
          <i class="cogs icon"></i>
        </a>
      </div>
    </div>
    <hr>
    <div class="ui four column grid">
      <div class="column" *ngFor="let elem of playList; let index = index; let isLast = last;">
        <div [id]="elem.id" class="ui card" (click)="goLaunch(this.elem)" (mouseenter)="showProgressIndicator(elem.id, index)" (mouseleave)="hideProgressIndicator(elem.id, index)">
          <div class="image">
            <img [src]="elem.thumbnail" alt="" (click)="openDialog(this.elem)">
          </div>
          <mat-progress-spinner [id]="index"
                                class="progressIndicator"
                                color="warn"
                                mode="determinate"
                                [value]="spinnerValue">
          </mat-progress-spinner>
          <div class="content" *ngIf="elem.types != 'btnAdd'">
            <a class="header">{{ elem.title }}</a>
            <div class="meta">
              <span class="date">
                {{ elem.artists }}
              </span>
              <span class="ui right floated date">{{ elem.publishedAt | date:'mediumDate' }}</span>
            </div>
            <div class="description">
              {{ elem.description?.slice(0,50) }}
            </div>
            <button class="ui right floated tiny red right labeled icon button" *ngIf="edit" (click)="goDelete(this.elem)">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
    <hr>
    <div *ngIf="launch" class="ui three column grid centered">
      <div class="btnVideo right aligned">
        <button id="previousBtn" class="ui left labeled icon button"
                (click)="goPrevious()"
                (mouseenter)="showProgressIndicator('previousBtn', 'previousProgressSpinner')"
                (mouseleave)="hideProgressIndicator('previousBtn', 'previousProgressSpinner')">
          <i class="left arrow icon"></i>
          Previous
          <mat-progress-spinner id="previousProgressSpinner"
                                class="progressIndicator"
                                color="warn"
                                mode="determinate"
                                [value]="spinnerValue"
                                disabled>
          </mat-progress-spinner>
        </button>
      </div>
      <div *ngIf="!fullScreen && currentElem.types == 'YouTube'" class="ui header">
        <iframe width="560"
                height="315"
                [src]="currentElem.id | yt"
                frameborder="0"
                allowtransparency="true"
                allow="encrypted-media">
        </iframe>
      </div>
      <div *ngIf="fullScreen && currentElem.types == 'YouTube'" class="ui header">
        <iframe id="myVideoYouTube"
                width="560"
                height="315"
                [src]="goFullScreen()"
                frameborder="0"
                allow="autoplay"
                allowfullscreen>
        </iframe>
      </div>
      <div *ngIf="currentElem.types == 'Spotify'" class="ui header">
        <iframe [src]="currentElem.id | uri"
                width="560" height="315"
                frameborder="0"
                allowtransparency="true"
                allow="encrypted-media">
        </iframe>
      </div>
      <div *ngIf="currentElem.types == 'song'" class="ui header">
        <figure>
          <figcaption>{{currentElem.title}}</figcaption>
          <audio preload="metadata" controls #myAudio>
            <source [src]="getSrcFile()">
          </audio>
          <figcaption>{{currentElem.artists}}</figcaption>
          <figcaption>
            <button class="ui labeled icon button" (click)="goPlay()">
              <i class="play icon"></i>
              Play
            </button>
            <button class="ui right labeled icon button" (click)="goPause()">
              <i class="pause icon"></i>
              Pause
            </button>
          </figcaption>
        </figure>
      </div>
      <div *ngIf="currentElem.types == 'video'" class="ui header">
        <figure>
          <figcaption>{{currentElem.title}}</figcaption>
          <video controls muted preload="metadata" width="560" height="315" #myVideo>
            <source [src]="getSrcFile()">
          </video>
          <figcaption>{{currentElem.artists}}</figcaption>
          <figcaption>
            <button class="ui labeled icon button" (click)="goPlay()">
              <i class="play icon"></i>
              Play
            </button>
            <button class="ui right labeled icon button" (click)="goPause()">
              <i class="pause icon"></i>
              Pause
            </button>
          </figcaption>
        </figure>
      </div>
      <div class="btnVideo left aligned">
        <button id="nextBtn" class="ui right labeled icon button"
                (click)="goNext()"
                (mouseenter)="showProgressIndicator('nextBtn', 'nextProgressSpinner')"
                (mouseleave)="hideProgressIndicator('nextBtn', 'nextProgressSpinner')">
          <i class="right arrow icon"></i>
          Next
          <mat-progress-spinner id="nextProgressSpinner"
                                class="progressIndicator"
                                color="warn"
                                mode="determinate"
                                [value]="spinnerValue">
          </mat-progress-spinner>
        </button>
        <button *ngIf="currentElem.types == 'YouTube'"
          class="ui button" (click)="goFullScreen()">
          Full screen
        </button>
      </div>
    </div>
  </div>
</div>
<notifier-container></notifier-container>
